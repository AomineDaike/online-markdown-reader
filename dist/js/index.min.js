!function(){function e(e){e.stopPropagation(),e.preventDefault(),$("#upload").css("border-color","#3bafda")}function t(e){e.stopPropagation(),e.preventDefault(),$("#upload").css("border-color","#ddd")}function a(e){e.stopPropagation(),e.preventDefault(),$("#upload").css("border-color","#ddd"),null!=e.dataTransfer.files&&null!=e.dataTransfer.files[0]&&n(e.dataTransfer.files[0])}function o(e){e.stopPropagation(),e.preventDefault(),null!=this.files&&null!=this.files[0]&&n(this.files[0])}function n(e){if(E=e,!I(E.name)){var t=$("[data-remodal-id=md-tip]").remodal();return void t.open()}$("#loader").css("display","block");var a=new FileReader;a.readAsText(E),M=C(E.name),a.onload=function(e){P=e.target.result,F.cache?i(M,P):r(),s(P)}}function s(e){q.length=0,N="",g(e),$("#content").html(marked(e)),u(),F.genToc&&v(),F.highlight==z.highlight?$("pre code").each(function(e,t){hljs.highlightBlock(t)}):($("pre").addClass("line-numbers"),Prism.highlightAll()),F.mathjax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub,"content"]),F.emoji&&emojify.run(document.getElementById("content")),F.sd&&$(".diagram").sequenceDiagram({theme:"simple"}),$("#loader").css("display","none"),j()}function l(){null==E?s(P):n(E)}function i(e,t){if(t.length>O){var a=$("[data-remodal-id=size-tip]").remodal();return a.open(),void r()}localStorage.setItem(z.mdName,e),localStorage.setItem(z.mdContent,t)}function r(){localStorage.removeItem(z.mdName),localStorage.removeItem(z.mdContent)}function c(e){e.stopPropagation(),e.preventDefault(),$("#img-upload").css("border-color","#3bafda")}function d(e){e.stopPropagation(),e.preventDefault(),$("#img-upload").css("border-color","#ddd")}function h(e){e.stopPropagation(),e.preventDefault();var t=$("[data-remodal-id=modal]").remodal();t.close(),$("#img-upload").css("border-color","#ddd"),p(e.dataTransfer.files)}function m(e){e.stopPropagation(),e.preventDefault();var t=$("[data-remodal-id=modal]").remodal();t.close(),$("#img-upload").css("border-color","#ddd"),p(this.files)}function p(e){var t,a=e.length,o=0;for(t=0;t<e.length;t++)if(!L(e[t].name)){var n=$("[data-remodal-id=img-tip]").remodal();return void n.open()}for($("#loader").css("display","block"),t=0;t<e.length;t++){var s=e[t],l=new FileReader;l.readAsDataURL(s),function(e,t){e.onload=function(e){if(F.compressImg){var n=new Image;n.src=e.target.result;var s=w(t.name),l="image/png";"jpg"!=s.toLowerCase()&&"jpeg"!=s.toLowerCase()||(l="image/jpeg"),D[t.name]=f(n,l)}else D[t.name]=e.target.result;o++,o==a&&u()}}(l,s)}}function u(){var e,t=$("img");for(e=0;e<t.length;e++){var a;null==$(t[e]).attr("pname")?(a=t[e].src,$(t[e]).attr("pName",a)):a=$(t[e]).attr("pname");var o=T(a);D.hasOwnProperty(o)&&(t[e].src=D[o])}$("#loader").css("display","none")}function f(e,t){var a=862,o=document.createElement("canvas"),n=e.width,s=e.height;null!=t&&""!=t||(t="image/png"),n>a&&(s=Math.round(s*=a/n),n=a),o.width=n,o.height=s;var l=o.getContext("2d");return l.drawImage(e,0,0,n,s),o.toDataURL(t)}function g(e){var t,a=/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/gim;if(H=e.indexOf(z.tocTag),R=0,H==-1)return void(B=!1);for(B=!0;null!=(t=a.exec(e))&&!(t.index>H);)R++}function v(){var e,t,a,o=0,n=F.tocLevel,s="",l=0;for(J=5,e=R;e<q.length;e++)a=q[e],a.level<J&&(J=a.level);for(o=J-1,e=R;e<q.length;e++)if(a=q[e],!(a.level>n)){if(o>a.level){for(t=o-a.level;t>=0;t--)s+="</ul>",l--;s+="<ul>",l++}if(o<a.level)for(t=a.level-o;t>0;t--)s+="<ul>",l++;s+="<li><a href='#"+a.slug+"'>"+a.title+"</a></li>",o=a.level}for(e=0;e<l;e++)s+="</ul>";if(B){var i=$("#content").html();i=i.replace(z.tocTag,s),$("#content").html(i)}else $("#content").prepend(s)}function b(){var e=localStorage.getItem(z.mdContent);return null==e||""==e?void $("#loader").css("display","none"):(M=localStorage.getItem(z.mdName),console.log(M),P=e,s(P),void $("#loader").css("display","none"))}function x(){var e=localStorage.getItem(z.setting);if(null!=e){e=JSON.parse(e);for(var t in e){var a=e[t];void 0!==a?t in F&&(F[t]=a):console.warn("'"+t+"' parameter is undefined.")}}}function k(){s(P),localStorage.setItem(z.setting,JSON.stringify(F))}function y(){$("[name='set']").each(function(e,t){$(t).prop("checked",F[$(t).attr("ref")]),$(t).change(function(e){F[$(t).attr("ref")]=$(t).is(":checked"),k()})}),$("#s_toc").prop("checked",F.genToc),$("#toc-level").val(F.tocLevel),$("#s_toc").change(function(e){F.genToc=$("#s_toc").is(":checked"),F.genToc?$("#toc-level").prop("disabled",!1):$("#toc-level").prop("disabled",!0),k()}),$("#toc-level").change(function(e){var t=parseInt($("#toc-level").val());t<1&&(t=1),t>5&&(t=5),F.tocLevel=t,$("#toc-level").val(t),k()}),F.highlight==z.highlight?$("#s_highlight").prop("checked",!0):$("#s_prism").prop("checked",!0),$("[name='high']").each(function(e,t){$(t).change(function(e){var a=$(t).prop("id");"s_highlight"==a?F.highlight=z.highlight:F.highlight=z.prism,k()})})}function j(){$("#fold").removeClass("fa-minus-square"),$("#fold").addClass("fa-plus-square"),$("#upload-area").addClass("upload-area-close"),$("#fold").attr("expand",!1)}function C(e){return e.substr(0,e.lastIndexOf("."))||e}function T(e){return e.substr(e.lastIndexOf("/")+1)}function w(e){return e.substr(e.lastIndexOf(".")+1)||e}function I(e){var t=/(\.md|\.markdown|\.txt|\.mkd|\.text)$/i;return!!t.test(e)}function L(e){var t=/(\.png|\.jpg|\.gif|\.bmp)$/i;return!!t.test(e)}var E,S=document.getElementById("select-file"),_=document.getElementById("img-select"),D={},M="",P="",O=4194304,q=[],A=0,N="",R=0,H=-1,B=!1,J=5,z={highlight:"highlight",prism:"prism",mdName:"mdName",mdContent:"mdContent",tocTag:"<!-- toc -->",setting:"setting"},F={compressImg:!0,genToc:!0,tocLevel:5,highlight:z.prism,cache:!0,mathjax:!0,sd:!0,emoji:!0,backtop:!0},U=new marked.Renderer;U.listitem=function(e){return/^\s*\[[x ]\]\s*/.test(e)?(e=e.replace(/^\s*\[ \]\s*/,'<input type="checkbox" class="task-list-item-checkbox" disabled> ').replace(/^\s*\[x\]\s*/,'<input type="checkbox" class="task-list-item-checkbox" disabled checked> '),'<li style="list-style: none">'+e+"</li>"):"<li>"+e+"</li>"},U.heading=function(e,t){var a=e.toLowerCase().replace(/[\s]+/g,"-");return N.indexOf(a)!=-1&&(a+="-"+A,A++),N+=a,q.push({level:t,slug:a,title:e}),"<h"+t+' id="'+a+'"><a href="#'+a+'" class="anchor"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>'+e+"</h"+t+">"};var V=U.code;U.code=function(e,t){return"seq"==t?"<div class='diagram' id='diagram'>"+e+"</div>":V.call(this,e,t)},marked.setOptions({renderer:U}),S.addEventListener("dragenter",e,!1),S.addEventListener("dragleave",t,!1),S.addEventListener("drop",a,!1),S.addEventListener("change",o,!1),_.addEventListener("dragenter",c,!1),_.addEventListener("dragleave",d,!1),_.addEventListener("drop",h,!1),_.addEventListener("change",m,!1),$("#fold").click(function(){"true"==$("#fold").attr("expand")?($("#fold").removeClass("fa-minus-square"),$("#fold").addClass("fa-plus-square"),$("#upload-area").addClass("upload-area-close"),$("#fold").attr("expand",!1)):($("#fold").removeClass("fa-plus-square"),$("#fold").addClass("fa-minus-square"),$("#upload-area").removeClass("upload-area-close"),$("#fold").attr("expand",!0))}),$("#export").click(function(){var e="",t="",a="";F.highlight==z.highlight?t+='<link href="http://cdn.bootcss.com/highlight.js/9.8.0/styles/atom-one-light.min.css" rel="stylesheet">':(t+='<link href="http://cdn.bootcss.com/prism/9000.0.1/themes/prism.min.css" rel="stylesheet">',t+='<link href="http://cdn.bootcss.com/prism/9000.0.1/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">'),F.emoji&&(t+='<link href="http://cdn.bootcss.com/emojify.js/1.1.0/css/basic/emojify.min.css" rel="stylesheet">'),F.mathjax?(0==F.mathjax,s(P),e=$("#content").html(),1==F.mathjax,s(P)):e=$("#content").html(),F.mathjax&&(a+="<script type=\"text/x-mathjax-config\">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});</script>"+'<script type="text/javascript" src="http://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>'),F.backtop&&(t+='<link href="http://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">',t+=' <link rel="stylesheet" href="http://localhost:81/assets/lib/backtotop/backtotop.css">',a+='<script src="http://cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>',a+='<script type="text/javascript" src="http://localhost:81/assets/lib/backtotop/backtotop.js"></script>',a+='<script type="text/javascript">backToTop.init()</script> ');var e='<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>markdown</title>'+t+'<link rel="stylesheet" href="http://10.64.0.124:81/assets/css/markdown.css"></head><body>'+e+a+"</body></html>",o=M+".html",n=new Blob([html_beautify(e,{indent_size:4})],{type:"text/html;charset=utf-8"});saveAs(n,o)}),$("#refresh").click(function(){l()}),emojify.setConfig({emojify_tag_type:"div",only_crawl_id:null,img_dir:"http://cdn.bootcss.com/emojify.js/1.0/images/basic",ignored_tags:{SCRIPT:1,TEXTAREA:1,A:1,PRE:1,CODE:1}}),backToTop.init({theme:"classic",animation:"fade"}),x(),y(),b()}();